'use strict';

var _hapi = require('hapi');

var _hapi2 = _interopRequireDefault(_hapi);

var _opn = require('opn');

var _opn2 = _interopRequireDefault(_opn);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var debug = require('debug')('gatsby:application');

module.exports = function (program) {
  var directory = program.directory;

  debug('Serving /public');

  // Setup and start Hapi to static files.

  var server = new _hapi2.default.Server();

  server.connection({
    host: program.host,
    port: program.port
  });

  server.route({
    method: 'GET',
    path: '/{path*}',
    handler: {
      directory: {
        path: directory + '/public',
        listing: false,
        index: true
      }
    }
  });

  server.start(function (e) {
    if (e) {
      console.log(e);
    }
    if (program.open) {
      (0, _opn2.default)(server.info.uri);
    }
    return console.log('Listening at:', server.info.uri);
  });
};